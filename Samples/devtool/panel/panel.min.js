!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=2)}([function(e,t,n){"use strict";t.a=class{constructor(){this.events={}}registerEvent(e,t){if(this.events||(this.events={}),!this.events[e])return void(this.events[e]=t);const n=this.events[e];this.events[e]=(e=>{n(e),t(e)})}}},function(e,t,n){"use strict";var i=n(0),s=n(3);t.a=1e3;t.b=class extends i.a{constructor(){super(),this.maxLevels=null,this.history=[],this.disabled=!1,this.events={change:()=>{}}}changeMaxLevels(e){this.maxLevels=parseInt(e)}disable(e=!0){this.disabled=e}add({event:e,state:t,element:n}){this.disabled||(this.maxLevels&&0!==this.maxLevels&&this.history.length>=this.maxLevels&&this.history.splice(0,this.history.length+1-this.maxLevels),this.history.push({time:new Date,event:e,element:n,state:t}),this.events.change(this))}clean(){this.history=[],this.history.length=0,this.events.change(this)}getConsumedMemory(){return s.a.calculate(this.history)}getList(){return this.history}toItem(e){const t=parseInt(e),n=this.history[t];return this.moveHeader(t),this.events.change(this),n}getItem(e){return this.history[parseInt(e)]}moveHeader(e){this.history.length=e+1}getMoment(e){return this.history.find(t=>t.time===e)}getLength(){return this.history.length}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=n(4),a=n(5),r=n(6),c=n(7),o=n(8),h=n(9);const l=new i.b,m=new a.a(l),d=new o.a(l),u=new c.a,g=new s.a,p=new h.a,v=new r.a;l.registerEvent("change",m.update.bind(m)),l.registerEvent("change",v.updateMemoryField.bind(v)),p.registerEvent("onLevelChange",l.changeMaxLevels.bind(l)),p.loadConfig(),g.registerEvent("initValues",v.reciveValues.bind(v)),g.registerEvent("initValues",u.drawTable.bind(u)),g.registerEvent("updateValues",u.updateValues.bind(u)),g.registerEvent("updateValues",d.update.bind(d)),g.registerEvent("reciveMark",v.changeMark.bind(v)),g.registerEvent("activeMark",v.activeMark.bind(v)),g.registerEvent("onReceiveUpdate",l.add.bind(l)),g.registerEvent("onClean",l.clean.bind(l)),v.registerEvent("onDeleteHistory",l.clean.bind(l)),v.registerEvent("onDeleteHistory",g.deleteHistory.bind(g)),v.registerEvent("onApply",g.applyState.bind(g)),v.registerEvent("onActiveMarksChange",g.activeMarks.bind(g)),v.registerEvent("onMarkChange",g.sendMark.bind(g)),v.registerEvent("onConnect",g.sendConnect.bind(g)),v.registerEvent("onFilterHitmap",d.onSearchChange.bind(d)),m.registerEvent("onApply",g.applyState.bind(g)),m.registerEvent("onRestore",g.restoreScores.bind(g)),g.begin()},function(e,t,n){"use strict";class i{static sizeOf(e){let t=0;if(null!==e&&void 0!==e)switch(typeof e){case"number":t+=8;break;case"string":t+=2*e.length;break;case"boolean":t+=4;break;case"object":const n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n||"Array"===n)for(const n in e)e.hasOwnProperty(n)&&(t+=i.sizeOf(e[n]));else t+=2*e.toString().length}return t}static formatByteSize(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(3)+" KiB":e<1073741824?(e/1048576).toFixed(3)+" MiB":(e/1073741824).toFixed(3)+" GiB"}static calculate(e){const t=i.sizeOf(e);return i.formatByteSize(t)}}t.a=i},function(e,t,n){"use strict";var i=n(0);t.a=class extends i.a{constructor(){super(),this.tabId=chrome.devtools.inspectedWindow.tabId,this.init=!1,this.port=chrome.runtime.connect(null,{name:"panel"}),this.updating=!1,this.events={updateValues:()=>{},initValues:()=>{},activeMark:()=>{},reciveMark:()=>{},onReceiveUpdate:()=>{},onClean:()=>{}},this.port.onMessage.addListener(e=>{if("panel"===e.target)switch(e.action){case"aie-update":this.receiveUpdate(e);break;case"aie-reset":this.events.activeMark(!1);break;case"aie-mark":case"aie-unmark":this.events.reciveMark(e.name,!1)}})}begin(){this.post({action:"init"})}post(e){e.tabId=this.tabId,e.target="content",this.port.postMessage(e)}send(e){e.tabId=this.tabId,e.target="content",chrome.runtime.sendMessage(e)}receiveUpdate({detail:e}){if(this.updating||!e)return;this.updating=!0;const{state:t,event:n,element:i}=JSON.parse(e);this.events.onReceiveUpdate({event:n,state:t,element:i}),0==this.init?(this.init=!0,this.events.initValues(t)):this.events.updateValues(t),this.updating=!1}sendMark({name:e,value:t}){this.send({action:t?"aie-mark":"aie-unmark",name:e})}sendConnect(){this.init=!1,this.events.onClean(),this.send({action:"aie-connect",name:name})}restoreScores(e=null){this.send({action:"aie-restore",state:e})}applyState(e=null){this.send({action:"aie-apply",state:e})}activeMarks(e){this.send({action:e?"aie-active-mark":"aie-unactive-mark"})}deleteHistory(){this.send({action:"aie-trash"})}}},function(e,t,n){"use strict";var i=n(0);t.a=class extends i.a{constructor(e){super(),this.templateTimemachine=document.getElementById("timemachine-template").innerHTML,this.content=document.getElementById("timemachine-table"),this.history=e,this.events={onApply:()=>{},onRestore:()=>{}},document.addEventListener("click",e=>{const t=e.srcElement;if(t&&t.hasAttribute("aie-history-restore-index")){const{state:e}=this.history.toItem(t.getAttribute("aie-history-restore-index"));this.events.onRestore(e)}if(t&&t.hasAttribute("aie-history-apply-index")){const{state:e}=this.history.getItem(t.getAttribute("aie-history-apply-index"));this.events.onApply(e)}},!1)}generateHistoryItem({index:e,event:t,element:n,time:i}){let s=this.templateTimemachine.replace(/{index}/g,e);return s=(s=(s=(s=s.replace(/{event}/g,t)).replace(/{element}/g,n)).replace(/{name}/g,name)).replace(/{time}/i,i.toTimeString())}update(){this.content.innerHTML=this.history.getList().map(({time:e,event:t,element:n},i)=>this.generateHistoryItem({index:i,element:n,event:t,time:e})).join("")}}},function(e,t,n){"use strict";var i=n(0);t.a=class extends i.a{constructor(){super(),this.events={onMarkChange:()=>{},onDeleteHistory:()=>{},onConnect:()=>{},onActiveMarksChange:()=>{},onApply:()=>{},onFilterHitmap:()=>{}},this.loader=document.getElementById("loader"),this.container=document.getElementById("container"),this.hitmapChecker=document.getElementById("hitmap-checker"),document.addEventListener("mouseover",e=>this.onMouseOver(e.srcElement)),document.addEventListener("mouseout",e=>this.onMouseOut(e.srcElement)),document.addEventListener("click",e=>this.onClick(e.srcElement)),document.getElementById("active-marks-checker").addEventListener("change",e=>this.events.onActiveMarksChange(e.srcElement.checked?"aie-active-mark":"aie-unactive-mark"),!1),document.getElementById("toolbar-delete").addEventListener("click",e=>{this.events.onDeleteHistory()},!1),document.getElementById("toolbar-connect").addEventListener("click",e=>{this.events.onConnect()},!1),document.getElementById("toolbar-apply").addEventListener("click",e=>{this.events.onApply()},!1)}updateMemoryField(e){document.getElementById("memorySize").innerHTML=e.getConsumedMemory()}changeMark(e,t){const n=document.getElementById("label_"+e);n&&(t?n.classList.add("mark"):n.classList.remove("mark"))}activeMark(e){document.getElementById("active-marks-checker").checked=e}onMouseOver(e){e.hasAttribute("aie-name")&&this.events.onMarkChange({name:e.getAttribute("aie-name"),value:!0})}reciveValues(){this.loader.classList.add("hide"),this.container.classList.remove("hide")}onMouseOut(e){e.hasAttribute("aie-name")&&this.events.onMarkChange({name:e.getAttribute("aie-name"),value:!1})}onClick(e){e.hasAttribute("hitmap-filter")&&(this.events.onFilterHitmap(e.getAttribute("hitmap-filter")),this.hitmapChecker.checked=!0)}}},function(e,t,n){"use strict";t.a=class{constructor(){this.templateItem=document.getElementById("item-template").innerHTML,this.propertyItem=document.getElementById("item-property").innerHTML,this.templateList=document.getElementById("list-template").innerHTML,this.table=document.getElementById("state-table")}clean(){this.history=[],this.events.change(this)}generateList(e,t){return e&&0!==e.length?this.templateList.replace(/{items}/,e.map((e,n)=>this.generateItem(e,`${t}_${n}`)).join("")):""}getPrestace(e){return e?e.toFixed(4):""}generateItem({name:e,prestance:t,properties:n,children:i},s){let a=this.templateItem.replace(/{id}/g,e);return a=(a=(a=(a=a.replace(/{name}/g,e)).replace(/{properties}/g,n.map(e=>this.propertyItem.replace(/{property}/i,e)).join(""))).replace(/{value}/i,this.getPrestace(t))).replace(/{content}/i,this.generateList(i,s))}drawTable(e){e&&(this.table.innerHTML=this.generateList(e,"0"))}flatTree(e){return e&&0!==e.length?e?e.reduce((e,{name:t,prestance:n,children:i})=>[...e,...this.flatTree(i),{name:t,prestance:n}],[]):void 0:[]}updateValues(e){if(!e||0===e.length)return null;const t=this.flatTree(e),n=t.map(e=>e.prestance).reduce((e,t)=>Math.min(e,t),1),i=t.map(e=>e.prestance).reduce((e,t)=>Math.max(e,t),0);e&&t.map(({name:e,prestance:t})=>{const s=document.getElementById(`value_${e}`),a=document.getElementById(`arrow_${e}`);if(s){const e="rgb(100, 100, "+parseInt(255*(t-n)/(i-n))+")";s.style.color=e,a.style.color=e;const r=parseFloat(s.innerHTML);a.innerHTML=r>t?"&darr;":r<t?"&uarr;":r?"=":"",s.innerHTML=this.getPrestace(t)}})}}},function(e,t,n){"use strict";t.a=class{constructor(e){this.templateTimemachine=document.getElementById("timemachine-template"),this.image=document.getElementById("hitmap-image"),this.input=document.getElementById("hitmap-input"),this.search=document.getElementById("hitmap-search"),this.printButton=document.getElementById("hitmap-print"),this.history=e,this.index=0,this.maxPrestance=0,this.searchItem=null,this.imageHeight=null,this.imageWidth=null,this.input.addEventListener("input",e=>this.onInputChange(e.currentTarget.value)),this.search.addEventListener("change",e=>this.onSearchChange(e.currentTarget.value)),this.printButton.addEventListener("click",()=>this.printSVG()),this.templateRectagle=document.getElementById("hitmap-rectangle").innerHTML,this.templateOption=document.getElementById("hitmap-search-option").innerHTML,this.templatePrintable=document.getElementById("svg-print").innerHTML}onSearchChange(e){this.searchItem=e,this.onInputChange(this.input.value)}onInputChange(e){const t=parseInt((this.history.getLength()-1)*e/100);this.updateImage(this.history.getItem(t))}flatTree(e,t){return e&&0!==e.length?e?t?e.reduce((e,{name:n,children:i})=>{const s=n===t?this.flatTree(i,null):this.flatTree(i,t);return[...e,...s]},[]):e.reduce((e,{name:t,prestance:n,children:i,physicalAttribute:s})=>[...e,{name:t,prestance:n,physicalAttribute:s},...this.flatTree(i,null)],[]):void 0:[]}updateMaxPrestance(e){e.forEach(({prestance:e})=>{e>this.maxPrestance&&(this.maxPrestance=e)})}getFillColor(e){const t=parseInt(e/this.maxPrestance*255);return"rgb("+[t,30,t].join(",")+")"}getRectagle({physicalAttribute:e,prestance:t,name:n}){const{left:i,top:s,width:a,height:r}=e;return void 0!==i&&t?this.templateRectagle.replace(/{left}/g,i).replace(/{top}/g,s).replace(/{width}/g,a).replace(/{height}/g,r).replace(/{fill}/g,this.getFillColor(t)).replace(/{x}/g,i+2).replace(/{y}/g,s+8).replace(/{name}/g,n):""}update(e){const t=this.flatTree(e);this.updateMaxPrestance(t),this.input.value=100,this.onInputChange(100)}updateImage({state:e}){let t=0,n=0;const i=this.flatTree(e,this.searchItem).map(({physicalAttribute:e,prestance:i,name:s})=>{const{width:a,top:r,left:c,height:o}=e;return o+r>t&&(t=o+r),c+a>n&&(n=c+a),e?this.getRectagle({physicalAttribute:e,prestance:i,name:s}):""}).join("");this.search.innerHTML=this.flatTree(e,null).map(({name:e})=>this.templateOption.replace(/{name}/g,e).replace(/{selected}/g,this.searchItem===e?"selected":"")).join(""),this.image.innerHTML=i,this.imageWidth=n,this.imageHeight=t,this.image.setAttribute("viewBox",[0,0,n,t].join(" "))}createNewWindowForSVG(e){if(this.imageWidth&&this.imageHeight){const t=this.templatePrintable.replace(/{content}/g,this.image.innerHTML).replace(/{width}/g,this.imageWidth).replace(/{height}/g,this.imageHeight);e.document.write(t)}}printSVG(){if(this.imageWidth&&this.imageHeight){const e=window.open("","_blank","width=200 ,height=200",!0);setTimeout(this.createNewWindowForSVG.bind(this,e),500)}}}},function(e,t,n){"use strict";var i=n(0),s=n(1);t.a=class extends i.a{constructor(){super(),this.levels=document.getElementById("config_level"),this.events={onLevelChange:()=>{}},this.levels.addEventListener("input",e=>this.onLevelChange(e.currentTarget.value))}loadConfig(){const e=localStorage.getItem("aie.config.levels");this.levels.value=e||s.a,this.events.onLevelChange(this.levels.value)}saveConfig(e,t){localStorage.setItem("aie.config."+e,t)}onLevelChange(e){this.events.onLevelChange(e),this.saveConfig("levels",e)}}}]);
//# sourceMappingURL=panel.min.js.map