!function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=2)}([function(e,t,n){"use strict";t.a=class{constructor(){this.events={}}registerEvent(e,t){if(this.events||(this.events={}),!this.events[e])return void(this.events[e]=t);const n=this.events[e];this.events[e]=(e=>{n(e),t(e)})}}},function(e,t,n){"use strict";var s=n(0),i=n(3);t.a=class extends s.a{constructor(){super(),this.maxItems=50,this.history=[],this.disabled=!1,this.events={change:()=>{}}}disable(e=!0){this.disabled=e}add({event:e,prestances:t,element:n}){this.disabled||(this.maxItems&&this.history.length>=this.maxItems&&this.history.splice(0,this.history.length+1-this.maxItems),this.history.push({time:new Date,event:e,element:n,prestances:t}),this.events.change(this))}clear(){this.history=[],this.events.change(this)}getConsumedMemory(){return i.a.calculate(this.history)}getList(){return this.history}toItem(e){const t=parseInt(e),n=this.history[t];return this.moveHeader(t),console.log("moveHeader",t),this.events.change(this),n}getItem(e){return this.history[parseInt(e)]}moveHeader(e){this.history.length=e+1}getMoment(e){return this.history.find(t=>t.time===e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),i=n(4),r=n(5),a=n(6),o=n(7);const c=new s.a,d=new r.a(c),l=new o.a,h=new i.a,m=new a.a;c.registerEvent("change",d.update.bind(d)),c.registerEvent("change",m.updateMemoryField.bind(m)),h.registerEvent("initValues",l.drawTable.bind(l)),h.registerEvent("updateValues",l.updateValues.bind(l)),h.registerEvent("reciveMark",m.changeMark.bind(m)),h.registerEvent("reciveMark",m.changeMark.bind(m)),h.registerEvent("onReceiveUpdate",c.add.bind(c)),m.registerEvent("onDeleteHistory",c.clear.bind(c)),m.registerEvent("onDeleteHistory",h.deleteHistory.bind(h)),m.registerEvent("onApply",h.applyPrestances.bind(h)),m.registerEvent("onActiveMarksChange",h.activeMarks.bind(h)),m.registerEvent("onMarkChange",h.sendMark.bind(h)),m.registerEvent("onConnect",h.sendConnect.bind(h)),d.registerEvent("onApply",h.applyPrestances.bind(h)),d.registerEvent("onRestore",h.restoreScores.bind(h)),h.begin()},function(e,t,n){"use strict";class s{static sizeOf(e){let t=0;if(null!==e&&void 0!==e)switch(typeof e){case"number":t+=8;break;case"string":t+=2*e.length;break;case"boolean":t+=4;break;case"object":const n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n||"Array"===n)for(const n in e)e.hasOwnProperty(n)&&(t+=s.sizeOf(e[n]));else t+=2*e.toString().length}return t}static formatByteSize(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(3)+" KiB":e<1073741824?(e/1048576).toFixed(3)+" MiB":(e/1073741824).toFixed(3)+" GiB"}static calculate(e){const t=s.sizeOf(e);return s.formatByteSize(t)}}t.a=s},function(e,t,n){"use strict";var s=n(0);t.a=class extends s.a{constructor(){super(),this.tabId=chrome.devtools.inspectedWindow.tabId,this.init=!1,this.port=chrome.runtime.connect(null,{name:"panel"}),this.updating=!1,this.events={updateValues:()=>{},initValues:()=>{},reciveMark:()=>{},onReceiveUpdate:()=>{}},this.port.onMessage.addListener(e=>{if("panel"===e.target)switch(e.action){case"aie-update":this.receiveUpdate(e);break;case"aie-mark":this.events.reciveMark(e.name,!0);break;case"aie-unmark":this.events.reciveMark(e.name,!1)}})}begin(){this.post({action:"init"})}post(e){e.tabId=this.tabId,e.target="content",this.port.postMessage(e)}send(e){e.tabId=this.tabId,e.target="content",chrome.runtime.sendMessage(e)}receiveUpdate({detail:e}){if(this.updating||!e)return;this.updating=!0;const{prestances:t,event:n,element:s}=JSON.parse(e);this.events.onReceiveUpdate({event:n,prestances:t,element:s}),0==this.init?(this.init=!0,this.events.initValues(t)):this.events.updateValues(t),this.updating=!1}sendMark({name:e,value:t}){this.send({action:t?"aie-mark":"aie-unmark",name:e})}sendConnect(){this.send({action:"aie-connect",name:name})}restoreScores(e=null){this.send({action:"aie-restore",prestances:e})}applyPrestances(e=null){this.send({action:"aie-apply",prestances:e})}activeMarks(e){this.send({action:e?"aie-active-mark":"aie-unactive-mark"})}deleteHistory(){this.send({action:"aie-trash"})}}},function(e,t,n){"use strict";var s=n(0);t.a=class extends s.a{constructor(e){super(),this.templateTimemachine=document.getElementById("timemachine-template").innerHTML,this.content=document.getElementById("timemachine"),this.history=e,this.events={onApply:()=>{},onRestore:()=>{}},document.addEventListener("click",e=>{const t=e.srcElement;if(t&&t.hasAttribute("aie-history-restore-index")){const{prestances:e}=this.history.toItem(t.getAttribute("aie-history-restore-index"));this.events.onRestore(e)}if(t&&t.hasAttribute("aie-history-apply-index")){const{prestances:e}=this.history.getItem(t.getAttribute("aie-history-apply-index"));this.events.onApply(e)}},!1)}generateHistoryItem({index:e,event:t,element:n,time:s}){let i=this.templateTimemachine.replace(/{index}/g,e);return i=(i=(i=(i=i.replace(/{event}/g,t)).replace(/{element}/g,n)).replace(/{name}/g,name)).replace(/{time}/i,s.toTimeString())}update(){this.content.innerHTML=this.history.getList().map(({time:e,event:t,element:n},s)=>this.generateHistoryItem({index:s,element:n,event:t,time:e})).join("")}}},function(e,t,n){"use strict";var s=n(0);t.a=class extends s.a{constructor(){super(),this.events={onMarkChange:()=>{},onDeleteHistory:()=>{},onConnect:()=>{},onActiveMarksChange:()=>{},onApply:()=>{}},document.addEventListener("mouseover",e=>this.onMouseOver(e.srcElement)),document.addEventListener("mouseout",e=>this.onMouseOut(e.srcElement)),document.getElementById("active-marks-checker").addEventListener("change",e=>this.events.onActiveMarksChange(e.srcElement.checked?"aie-active-mark":"aie-unactive-mark"),!1),document.getElementById("toolbar-delete").addEventListener("click",e=>{this.events.onDeleteHistory()},!1),document.getElementById("toolbar-connect").addEventListener("click",e=>{this.events.onConnect()},!1),document.getElementById("toolbar-apply").addEventListener("click",e=>{this.events.onApply()},!1),document.getElementById("timemachine-checker").addEventListener("change",e=>{e.srcElement.checked?(document.getElementById("timemachine").classList.remove("hide"),document.getElementById("container").classList.add("hide")):(document.getElementById("timemachine").classList.add("hide"),document.getElementById("container").classList.remove("hide"))},!1)}updateMemoryField(e){document.getElementById("memorySize").innerHTML=e.getConsumedMemory()}changeMark(e,t){const n=document.getElementById("label_"+e);n&&(t?n.classList.add("mark"):n.classList.remove("mark"))}onMouseOver(e){e.hasAttribute("aie-name")&&this.events.onMarkChange({name:e.getAttribute("aie-name"),value:!0})}onMouseOut(e){e.hasAttribute("aie-name")&&this.events.onMarkChange({name:e.getAttribute("aie-name"),value:!1})}}},function(e,t,n){"use strict";t.a=class{constructor(){this.templateItem=document.getElementById("item-template").innerHTML,this.templateList=document.getElementById("list-template").innerHTML,this.container=document.getElementById("container"),this.loader=document.getElementById("loader")}generateList(e,t){return e&&0!==e.length?this.templateList.replace(/{items}/,e.map((e,n)=>this.generateItem(e,`${t}_${n}`)).join("")):""}getPrestace(e){return e?e.toFixed(4):""}generateItem({name:e,prestance:t,children:n},s){let i=this.templateItem.replace(/{id}/g,e);return i=(i=(i=i.replace(/{name}/g,e)).replace(/{value}/i,this.getPrestace(t))).replace(/{content}/i,this.generateList(n,s))}drawTable(e){e&&(loader.classList.add("hide"),this.container.innerHTML=this.generateList(e,"0"))}flatTree(e){return e&&0!==e.length?e?e.reduce((e,{name:t,prestance:n,children:s})=>[...e,...this.flatTree(s),{name:t,prestance:n}],[]):void 0:[]}updateValues(e){if(!e||0===e.length)return null;const t=this.flatTree(e),n=t.map(e=>e.prestance).reduce((e,t)=>Math.min(e,t),1),s=t.map(e=>e.prestance).reduce((e,t)=>Math.max(e,t),0);e&&t.map(({name:e,prestance:t})=>{const i=document.getElementById(`value_${e}`),r=document.getElementById(`arrow_${e}`);if(i){const e="rgb(100, 100, "+parseInt(255*(t-n)/(s-n))+")";i.style.color=e,r.style.color=e;const a=parseFloat(i.innerHTML);a>t&&(r.innerHTML="&darr;"),a<t&&(r.innerHTML="&uarr;"),i.innerHTML=this.getPrestace(t)}})}}}]);
//# sourceMappingURL=panel.min.js.map